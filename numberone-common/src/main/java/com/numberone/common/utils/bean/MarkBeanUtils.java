package com.numberone.common.utils.bean;import com.numberone.common.annotation.MarkReason;import com.numberone.common.base.BaseEntity;import org.springframework.beans.factory.parsing.BeanEntry;import java.lang.reflect.Field;/** * @Author Nxy * @Date 2020/2/15 14:00 * @Description 统计评分实例中的加减分原因 */public class MarkBeanUtils {    /**     * @Author Nxy     * @Date 2020/2/15 14:14     * @Description 汇总加减分原因     */    public static void setMarkReasons(BaseEntity markBean) throws IllegalAccessException, NoSuchFieldException {        Class beanClass = markBean.getClass();        Field[] fields = beanClass.getDeclaredFields();        if (fields == null || fields.length == 0) {            throw new RuntimeException(markBean + " has no field");        }        Field targetField = beanClass.getDeclaredField("markReasons");        StringBuilder reasonsSb = new StringBuilder();        //遍历        for (Field field : fields) {            if (field.isAnnotationPresent(MarkReason.class)) {                //允许私有属性访问                field.setAccessible(true);                String isSubtraction = "-";                MarkReason reasonAnno = field.getAnnotation(MarkReason.class);                //判断是否减分项                if (!reasonAnno.isSubtraction()) {                    isSubtraction = "+";                }                Object markMark = field.get(markBean);                //如果某一评分项未评分，跳过                if (markMark == null) {                    continue;                }                String project = "";                //是否否决项                if (reasonAnno.isFouJue()) {                    project = "-100.0";                } else {                    project = isSubtraction + (double) markMark;                }                //拼装加减分原因                reasonsSb.append(reasonAnno.reasonName() + ":" + project + ";");            }        }        targetField.setAccessible(true);        targetField.set(markBean, reasonsSb.toString());    }}